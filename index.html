<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sestin - 8th Grade Science Robot</title>
    <link rel="stylesheet" href="style.css?v=4">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* Force override to ensuring Dashboard Grid is pushed down */
        .dashboard-grid {
            margin-top: 15vh !important;
            display: flex;
            justify-content: center;
            gap: 2rem;
            width: 100%;
            flex-wrap: wrap;
        }
    </style>
</head>

<body>
    <!-- Fixed Logout Button (Top Right) -->
    <div style="position: absolute; top: 20px; right: 20px; z-index: 9999;">
        <button id="fixed-logout-btn" class="fixed-logout-btn" style="display: none;">Logout ğŸšª</button>
    </div>

    <!-- Scroll Indicator -->
    <div id="scroll-indicator" class="scroll-indicator" style="display: none;">
        Select a topic first ğŸ‘† then go down to speak â¬‡ï¸
    </div>

    <!-- Login Overlay -->
    <div id="login-overlay" class="overlay">
        <div class="overlay-content">
            <!-- LOGIN SECTION -->
            <div id="login-section">
                <h1>ğŸ” Scientist Access</h1>
                <p>Please identify yourself to enter the lab.</p>
                <input type="text" id="username-input" placeholder="Scientist ID (firstname.lastname)"
                    style="padding: 10px; font-size: 1rem; margin-bottom: 10px; width: 80%;">
                <input type="password" id="password-input" placeholder="Access Code (123)"
                    style="padding: 10px; font-size: 1rem; margin-bottom: 10px; width: 80%;">

                <!-- Grade Selection -->
                <select id="login-grade-select"
                    style="padding: 10px; font-size: 1rem; margin-bottom: 20px; width: 80%; background: #334155; color: white; border: 1px solid #4ade80;">
                    <option value="" disabled selected>Select Your Grade ğŸ“…</option>
                    <option value="5">5th Grade</option>
                    <option value="8">8th Grade</option>
                    <option value="Biology">Biology</option>
                </select>
                <br>

                <button id="login-btn" class="start-btn">Enter Lab ğŸ§ª</button>
                <p id="login-error" style="color: #ff6b6b; margin-top: 10px; display: none;">
                    <b>Access Denied</b><br>Authorized Personnel Only.
                </p>
                <p style="margin-top: 15px; font-size: 0.9rem;">New Scientist? <a href="#" onclick="toggleSignUp()"
                        style="color: #4ade80;">Sign Up Here</a></p>
            </div>

            <!-- SIGNUP SECTION -->
            <div id="signup-section" style="display: none;">
                <h1>ğŸ“ New Scientist Registration</h1>
                <p>Welcome to the team! Identify yourself.</p>
                <input type="text" id="signup-name" placeholder="First Name"
                    style="padding: 10px; font-size: 1rem; margin-bottom: 10px; width: 80%;">
                <input type="text" id="signup-surname" placeholder="Last Name"
                    style="padding: 10px; font-size: 1rem; margin-bottom: 10px; width: 80%;">

                <select id="signup-school"
                    style="padding: 10px; font-size: 1rem; margin-bottom: 20px; width: 80%; background: #334155; color: white; border: 1px solid #4ade80;">
                    <option value="" disabled selected>Select Your School ğŸ«</option>
                    <option value="Apex">TMSA Apex</option>
                    <option value="Cary">TMSA Cary</option>
                    <option value="Concord">TMSA Concord</option>
                    <option value="Charlotte">TMSA Charlotte</option>
                    <option value="CO">TMSA CO</option>
                </select>
                <br>
                <button onclick="handleSignUp()" class="start-btn" style="background: #4ade80;">Register & Enter
                    ğŸš€</button>
                <p style="margin-top: 15px; font-size: 0.9rem;">Back to <a href="#" onclick="toggleSignUp()"
                        style="color: #6366f1;">Log In</a></p>
            </div>
        </div>
    </div>

    <!-- MAIN DASHBOARD (Unified View) -->
    <div id="main-dashboard" class="dashboard-container" style="display: none;">
        <h1 id="welcome-header" style="width: 100%; text-align: center; margin-bottom: 2rem;">Ready, Scientist?</h1>

        <div class="dashboard-row">
            <!-- Start Chat Button -->
            <div class="action-card" onclick="if(window.startApp) window.startApp()">
                <div class="card-icon">ğŸ¤</div>
                <h3>Start Session</h3>
                <p>Talk to Sestin</p>
            </div>

            <!-- Stats -->
            <div class="action-card" onclick="window.toggleStats()">
                <div class="card-icon">ğŸ“Š</div>
                <h3>My Stats</h3>
                <p>Track progress</p>
            </div>

            <!-- Journal -->
            <div class="action-card" onclick="window.toggleJournal()">
                <div class="card-icon">ğŸ““</div>
                <h3>Lab Journal</h3>
                <p>View notes</p>
            </div>
        </div>
    </div>

    <div class="app-wrapper">
        <!-- Sidebar (Hidden by default) -->
        <aside id="app-sidebar" class="app-sidebar" style="display: none;"></aside>

        <div class="container">
            <header>
                <h1>TMSA Curie</h1>
            </header>

            <!-- Science Background Elements -->
            <div class="science-bg">
                <div class="particle atom">âš›ï¸</div>
                <div class="particle dna">ğŸ§¬</div>
                <div class="particle microscope">ğŸ”¬</div>
                <div class="particle flask">ğŸ§ª</div>
                <div class="particle planet">ğŸª</div>
                <div class="particle rocket">ğŸš€</div>
                <!-- 21st Century Skills -->
                <div class="particle skill-collab" title="Collaboration">ğŸ¤</div>
                <div class="particle skill-think" title="Critical Thinking">ğŸ§ </div>
                <div class="particle skill-comm" title="Communication">ğŸ’¬</div>
                <div class="particle skill-create" title="Creativity">ğŸ’¡</div>
                <div class="particle skill-tech" title="Tech Literacy">ğŸ’»</div>
            </div>

            <div class="avatar-container">
                <div class="robot-container">
                    <img src="assets/teacher.png" id="avatar-img" class="avatar-img" alt="Teacher Sestin">
                </div>
            </div>

            <!-- OLD UI ELEMENTS REMOVED/REPLACED -->

            <div class="chat-area">
                <div class="messages"></div>
            </div>

            <div class="controls">
                <!-- Dynamic Content Here -->
            </div>
        </div>
    </div>

    <div class="chat-area">
        <div class="messages"></div>
    </div>

    <div class="controls">
        <!-- Dynamic Content Here -->
    </div>
    </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        // Signal when Firebase SDK is loaded
        window.dispatchEvent(new Event('firebaseLoaded'));
    </script>
    <script src="firebase_config.js"></script>
    <script src="firebase_manager.js"></script>

    <!-- Teacher Portal Trigger -->
    <div style="position: fixed; bottom: 10px; right: 10px; opacity: 0.1; transition: opacity 0.3s;"
        onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0.1">
        <button onclick="TeacherDashboard.open()"
            style="background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.3); color: white; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-size: 10px;">T</button>
    </div>

    <script src="secrets.js"></script>
    <script src="roster.js"></script> <!-- Added roster.js -->
    <script src="loader.js"></script>
    <script src="simulation_manager.js?v=2"></script>
    <script src="teacher_dashboard.js"></script>
    <script src="app_v5.js?v=8"></script>
</body>

</html>